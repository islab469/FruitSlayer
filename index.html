<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>果斷行動 - Fruit Slicing Game</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.4.0/p5.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/ml5@0.6.0/dist/ml5.min.js"></script>
    <link rel="stylesheet" href="style.css">
    <style>
        #gameContainer {
            position: relative;
            width: 100vw;
            height: 100vh;
            margin: 0;
            padding: 0;
            overflow: hidden;
        }
        canvas {
            position: absolute;
            top: 0;
            left: 0;
            z-index: 1;
        }
        .game-ui {
            position: relative;
            z-index: 2;
        }
        .hidden {
            display: none;
        }
    </style>
</head>
<body>
    <div id="gameContainer">
    <div class="background-fruits">
    </div>

        <div class="start-screen" id="startScreen">
        <div class="decorative-fruits">
            <img src="Assets/apple1.png" alt="Apple" class="fruit-decor apple1">
            <img src="Assets/watermelon1.png" alt="Watermelon" class="fruit-decor watermelon1">
            <img src="Assets/banana1.png" alt="Banana" class="fruit-decor banana1">
            <img src="Assets/strawberry1.png" alt="Strawberry" class="fruit-decor strawberry1">
            <img src="Assets/pitaya1.png" alt="Pitaya" class="fruit-decor pitaya1">
            <img src="Assets/durian1.png" alt="Durian" class="fruit-decor durian1">
        </div>
        <img src="Assets/Logo.png" alt="FruitSlayer Logo" class="game-logo">
            <button id="startButton">開始遊戲</button>
            <button id="ruleButton">遊戲說明</button>
            <p><small>注意：遊戲需要使用攝像頭來追踪你的手部動作</small></p>
        </div>

        <div class="loading-screen hidden" id="loadingScreen">
            <div class="loading-content">
                <h2>正在載入手部偵測模型</h2>
                <div class="loading-bar-container">
                    <div class="loading-bar" id="loadingBar"></div>
                </div>
                <p class="loading-text">請稍候，正在初始化遊戲...</p>
            </div>
        </div>

        <div class="modal hidden" id="ruleModal">
            <div class="modal-content">
                <span class="close" id="closeRule">&times;</span>
                <div class="game-desc">
                    <h2>🎮 遊戲玩法</h2>
                    <p>在這個充滿趣味的水果切切樂遊戲中，你將成為一位水果忍者大師！使用你的雙手在攝像頭前揮舞，切開飛躍的水果，獲得高分！</p>

                    <h2>🎯 遊戲目標</h2>
                    <p>每關需要獲得100分才能解鎖下一關。透過精準的切割和連擊combo來獲得更多分數！</p>

                    <h2>🔥 特色玩法</h2>
                    <ul>
                        <li><b>連擊獎勵：</b>連續切中3個以上水果可觸發Combo，每次連擊都會獲得額外加分！</li>
                        <li><b>神秘桃子：</b>遊戲時間結束時會出現特殊的桃子，在5秒內瘋狂切割以獲得豐厚的額外分數！
                            <ul>
                                <li>切割10次以上：額外獎勵50分</li>
                                <li>切割20次以上：額外獎勵100分</li>
                                <li>切割30次以上：額外獎勵200分</li>
                            </ul>
                        </li>
                    </ul>

                    <h2>🎚️ 關卡介紹</h2>
                    <ul>
                        <li><b>第一關 - 新手教學：</b>純粹的水果切割樂趣，熟悉基本操作。</li>
                        <li><b>第二關 - 榴槤挑戰：</b>小心危險的榴槤！切到會扣除生命值。</li>
                        <li><b>第三關 - 炸彈危機：</b>除了榴槤外還要躲避致命的炸彈，碰到炸彈遊戲立即結束！</li>
                        <li><b>第四關 - 終極挑戰：</b>更快的節奏、更多的障礙，考驗你的極限！</li>
                    </ul>

                    <h2>⚔️ 操作技巧</h2>
                    <ul>
                        <li>保持手部在攝像頭視野內，動作要大且清晰</li>
                        <li>使用流暢的切割動作可以提高命中率</li>
                        <li>注意切割軌跡的視覺回饋，幫助你掌握切割位置</li>
                        <li>在桃子模式中，小幅度快速切割效果最好</li>
                    </ul>

                    <h2>⚡ 遊戲提示</h2>
                    <ul>
                        <li>每局遊戲時間為20秒，把握時間獲取高分</li>
                        <li>善用Combo系統可以快速累積分數</li>
                        <li>遇到榴槤時可以暫時避開，等待更好的時機</li>
                        <li>注意生命值，保持警惕避開危險物品</li>
                    </ul>
                </div>
            </div>
        </div>
        
        <div class="start-screen hidden" id="levelSelect">
            <button id="exitLevelSelect" class="exit-btn">退出</button>
            <h1>選擇關卡</h1>
            <div class="level-buttons">
                <button id="levelBtn1">第一關：新手教學</button>
                <button id="levelBtn2">第二關：榴槤挑戰</button>
                <button id="levelBtn3">第三關：炸彈危機</button>
                <button id="levelBtn4">第四關：終極挑戰</button>
            </div>
            <p><small>選擇一個關卡開始遊戲</small></p>
        </div>
        
        <div class="game-stats hidden" id="gameStats">
            <div>分數: <span id="score">0</span></div>
            <div>生命: <span id="lives">3</span></div>
        </div>
        
        <div class="level-indicator hidden" id="levelIndicator">
            <div>等級: <span id="level">1</span></div>
        </div>
        
        <div class="combo-indicator hidden" id="comboIndicator">
            COMBO x<span id="comboCount">0</span>!
        </div>
        
        <div class="pause-menu hidden" id="pauseMenu">
            <div class="pause-content">
                <h2>遊戲暫停</h2>
                <button id="resumeButton">繼續遊戲</button>
                <button id="restartFromPause">重新開始</button>
                <button id="exitToMenu">返回選單</button>
            </div>
        </div>
        
        <div class="game-over-screen hidden" id="gameOverScreen">
            <h1>遊戲結束</h1>
            <p>太棒了！<br>你的最終分數: <span id="finalScore"></p>
            <div class="game-over-buttons">
            <button id="restartButton">再來一次</button>
                <button id="nextLevelButton" class="hidden">下一關</button>
                <button id="backToLevelSelect">回到選關</button>
            </div>
        </div>
    </div>

    <script src="sketch.js"></script>
</body>
</html>